<app-navbar></app-navbar>
<div class="container my-4">
    <div class="slider-photo" style="position: relative;">
        <img [src]="sliderData[selectedImage].image" width="100%" height="400px" />
        <i class="fa-solid fa-chevron-left"
            style="position:absolute;top: 50%;transform: translateY(-50%);left: 15px;color:white;"
            (click)="moveToPreImage()"></i>
        <h2 style="position: absolute;top: 50%;left: 50%;transform: translate(-50%,-50%);color:white">
            {{sliderData[selectedImage].title}}</h2>
        <i class="fa-solid fa-chevron-right"
            style="position:absolute;top: 50%;transform: translateY(-50%);right: 15px;color:white"
            (click)="moveToNextImage()"></i>
    </div>
    <!-- Tour Guides -->
    @defer (when isGuidesReqFinished) {
    @if(topTourGuides.length == 0){
    <h2 class="mx-auto fade-in">No Tour Guides Are Available</h2>
    }@else {
    <div class="top-tour-guides mt-5 fade-in-up">
        <h2 class="text-center mb-4">Top Tour Guides <button class="text-btn" routerLink="/tour-guides">View
                More</button></h2>
        <div class="row g-4">
            @for (guide of topTourGuides; track $index){
            <div class="col-6 col-md-4">
                <div class="tour-guide-card fade-in-up delay-{{$index}}">
                    <img [src]="guide.photoUrls![0]" alt="{{guide.guideName}}" class="tour-guide img-fluid">
                    <div class="tour-guide-name">{{guide.guideName}}</div>
                    <div class="tour-guide-rating">
                        <span class="rating-stars">
                            @for (i of [].constructor(5); track $index) {
                            <i class="bi bi-star-fill"
                                [ngClass]="{'text-warning': i < guide.averageRating!, 'text-secondary': i >= guide.averageRating!}"></i>
                            }
                        </span>
                        <span class="rating-value">({{guide.averageRating}})</span>
                    </div>
                </div>
            </div>
            }
        </div>
    </div>
    }
    }@placeholder {
    <mat-progress-spinner></mat-progress-spinner>
    }@loading (minimum 3s){
    <div class="loading-spinner mx-auto">
        <mat-progress-spinner mode="indeterminate" diameter="40"></mat-progress-spinner>
    </div>
    }

    <!-- Packages -->
    @defer (when isPackagesReqFinished) {
    @if(topTourPackages.length == 0){
    <h2 class="mx-auto fade-in">No Tour Packages Are Available</h2>
    }@else {
    <div class="top-tour-packages mt-5 fade-in-up">
        <h2 class="text-center mb-4">Top Packages <button class="text-btn" routerLink="/tour-packages">View
                More</button></h2>
        <div class="row g-4">
            @for (package of topTourPackages; track $index){
            <div class="col-6 col-md-4">
                <div class="tour-package-card fade-in-up delay-{{$index}}">
                    <img [src]="package.photoUrls![0]" alt="{{package.packageName}}" class="tour-guide img-fluid">
                    <div class="tour-guide-name">{{package.packageName}}</div>
                    <div class="tour-guide-price">{{package.price}}</div>
                </div>
            </div>
            }
        </div>
    </div>
    }
    }

    <!-- Hotels -->
    @defer (when isHotelsReqFinished) {
    @if(topHotels.length == 0){
    <h2 class="mx-auto fade-in">No Hotels Are Available</h2>
    }@else {
    <div class="top-hotels mt-5 fade-in-up">
        <h2 class="text-center mb-4">Top Hotels <button class="text-btn" routerLink="/hotel-reservation">View
                More</button></h2>
        <div class="row g-4">
            @for (hotel of topHotels; track $index){
            <div class="col-6 col-md-4">
                <div class="hotel-card fade-in-up delay-{{$index}}">
                    <img [src]="hotel.photoUrls![0]" alt="{{hotel.hotelName}}" class="tour-guide">
                    <div class="hotel-name">{{hotel.hotelName}}</div>
                    <div class="hotel-rating">
                        <span class="rating-stars">
                            @for (i of [].constructor(5); track $index) {
                            <i class="bi bi-star-fill"
                                [ngClass]="{'text-warning': i < hotel.rating!, 'text-secondary': i >= hotel.rating!}"></i>
                            }
                        </span>
                        <span class="rating-value">({{hotel.rating}})</span>
                    </div>
                    <div class="hotel-address">{{hotel.address}}</div>
                </div>
            </div>
            }
        </div>
    </div>
    }
    }

    <!-- Testimonials -->
    <div class="testimonals mt-5">
        <h2 class="text-center fade-in">Testimonials</h2>
        <div class="row mt-5">
            @for (item of topReviews; track $index) {
            <div class="col-12 my-3">
                <div class="testimonial-card fade-in-up delay-{{$index}}">
                    <div class="testimonial-content">
                        <p>{{item.comment}}</p>
                    </div>
                    <div class="rating-stars">
                        <ng-container *ngFor="let i of [0,1,2,3,4]">
                            <svg [ngClass]="{ 'filled': i < item.rating, 'empty': i >= item.rating }"
                                xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                                viewBox="0 0 24 24">
                                <path
                                    d="M12 .587l3.668 7.568L24 9.75l-6 5.797L19.335 24 12 19.897 4.665 24 6 15.547 0 9.75l8.332-1.595z" />
                            </svg>
                        </ng-container>
                        <span class="rating-value">({{ item.rating }})</span>
                    </div>
                    <div class="testimonial-date">
                        <p>{{item.reviewDate.split('T')[0]}}</p>
                    </div>
                </div>
            </div>
            }
        </div>
    </div>

    <!-- Stats -->
    <div class="stats mt-5">
        <div class="row g-5">
            <div class="col">
                <div class="card px-4 pt-2 bounce-in">
                    <h2>Hotels</h2>
                    <p>{{hotelsNumber}}</p>
                </div>
            </div>
            <div class="col">
                <div class="card px-4 pt-2 bounce-in delay-1">
                    <h2>Tour Guides</h2>
                    <p>{{hotelsNumber}}</p>
                </div>
            </div>
            <div class="col">
                <div class="card px-4 pt-2 bounce-in delay-2">
                    <h2>Packages</h2>
                    <p>{{packagesNumber}}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center mt-5 fade-in">
        <p>Â© 2024 EgyptTrip. All rights reserved.</p>
    </footer>
</div>